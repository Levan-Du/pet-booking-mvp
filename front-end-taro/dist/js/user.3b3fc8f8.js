var e=(e,s,a)=>new Promise((t,c)=>{var l=e=>{try{i(a.next(e))}catch(s){c(s)}},r=e=>{try{i(a.throw(e))}catch(s){c(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,r);i((a=a.apply(e,s)).next())});import{R as s,t as a,p as t,j as c,V as l,T as r,S as i,B as n,v as o}from"./vendors.5898faf2.js";import{u as d,h as m,C as h,e as p,j as x,A as u}from"./common.70eecc84.js";const j=()=>{const{t:j}=d(),[N,v]=s.useState("profile"),[g,_]=s.useState(null),[b,f]=s.useState([]);s.useEffect(()=>{const e=m();e&&_({phone:"138****8888",registerTime:"2024-01-01"})},[]);const y=()=>e(void 0,null,function*(){const e=yield p({url:u.USER_APPOINTMENTS_URL,method:"GET",header:{"Content-Type":"application/json"}});e.data.success&&f(e.data.data)});a.useReady(()=>{y()}),s.useEffect(()=>{var e;const s=null==(e=t().router)?void 0:e.params;console.log("user.tsx -> params",s),(null==s?void 0:s.tab)&&v(s.tab)},[]);const k=()=>{x(),a.redirectTo({url:"/pages/index/index"})},w=()=>{a.navigateTo({url:"/pages/store/store"})},C=e=>{const s=new Date(e);return`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}-${s.getDate().toString().padStart(2,"0")}`},T=e=>{const s={pending:j("appointment_status.pending"),confirmed:j("appointment_status.confirmed"),in_progress:j("appointment_status.in_progress"),completed:j("appointment_status.completed"),cancelled:j("appointment_status.cancelled"),broken:j("appointment_status.broken")};return s[e]||e},S=e=>{v(e),"appointment"===e&&y()};return c.jsxs(l,{className:"layout page-user",children:[c.jsx(h,{title:j("user.title"),showLanguageSwitcher:!0,showScanButton:!1,showLog:!1,showReports:!1}),c.jsx(l,{className:"container",children:c.jsxs(l,{className:"content-container",children:[g&&c.jsxs(l,{className:"user-info card",children:[c.jsx(l,{className:"avatar",children:c.jsx(r,{className:"avatar-text",children:"\ud83d\udc64"})}),c.jsxs(l,{className:"user-details",children:[c.jsx(r,{className:"phone",children:g.phone}),c.jsxs(r,{className:"register-time",children:[j("user.register_time"),": ",C(g.registerTime)]})]})]}),c.jsxs(l,{className:"tab-bar",children:[c.jsx(l,{className:"tab-item "+("profile"===N?"active":""),onClick:()=>v("profile"),children:c.jsx(r,{children:j("user.profile")})}),c.jsx(l,{className:"tab-item "+("appointment"===N?"active":""),onClick:()=>S("appointment"),children:c.jsx(r,{children:j("user.appointment")})}),c.jsx(l,{className:"tab-item "+("store"===N?"active":""),onClick:()=>v("store"),children:c.jsx(r,{children:j("user.store")})}),c.jsx(l,{className:"tab-item "+("services"===N?"active":""),onClick:()=>v("services"),children:c.jsx(r,{children:j("user.services")})}),c.jsx(l,{className:"tab-item "+("pets"===N?"active":""),onClick:()=>v("pets"),children:c.jsx(r,{children:j("user.pets")})}),c.jsx(l,{className:"tab-item "+("history"===N?"active":""),onClick:()=>v("history"),children:c.jsx(r,{children:j("user.history")})})]}),c.jsxs(i,{className:"tab-content",scrollY:!0,children:["profile"===N&&c.jsxs(l,{className:"tab-panel",children:[c.jsxs(l,{className:"profile-section card",children:[c.jsx(r,{className:"section-title",children:j("user.personal_info")}),c.jsxs(l,{className:"info-item",children:[c.jsxs(r,{className:"label",children:[j("user.phone_number"),":"]}),c.jsx(r,{className:"value",children:(null==g?void 0:g.phone)||j("user.not_logged_in")})]}),c.jsxs(l,{className:"info-item",children:[c.jsxs(r,{className:"label",children:[j("user.register_time"),":"]}),c.jsx(r,{className:"value",children:g?C(g.registerTime):j("user.not_registered")})]}),c.jsxs(l,{className:"info-item",children:[c.jsxs(r,{className:"label",children:[j("user.appointment_count"),":"]}),c.jsxs(r,{className:"value",children:[b.length,j("user.times")]})]})]}),c.jsxs(l,{className:"actions-section card",children:[c.jsx(r,{className:"section-title",children:j("user.actions")}),c.jsx(n,{className:"action-btn",onClick:()=>a.navigateTo({url:"/pages/index/index?action=add"}),children:j("user.new_appointment")}),c.jsx(n,{className:"action-btn logout",onClick:k,children:j("user.logout")})]})]}),"appointment"===N&&c.jsx(l,{className:"tab-panel",children:0===b.length?c.jsxs(l,{className:"empty-state card",children:[c.jsx(r,{className:"empty-text",children:j("user.no_appointments")}),c.jsx(n,{className:"book-btn",onClick:()=>a.navigateTo({url:"/pages/index/index"}),children:j("user.book_now")})]}):c.jsx(l,{className:"appointments-list",children:b.map((e,s)=>c.jsxs(l,{className:"appointment-card card",onClick:()=>a.navigateTo({url:`/pages/appointment-detail/appointment-detail?id=${e._id}`}),children:[c.jsxs(l,{className:"card-header",children:[c.jsxs(r,{className:"appointment-no",children:["#",e.appointment_no]}),c.jsx(l,{className:`status-badge ${e.status}`,children:T(e.status)})]}),c.jsxs(l,{className:"card-content",children:[c.jsxs(l,{className:"info-row",children:[c.jsxs(r,{className:"label",children:[j("user.service"),":"]}),c.jsx(r,{className:"value",children:e.service_name})]}),c.jsxs(l,{className:"info-row",children:[c.jsxs(r,{className:"label",children:[j("user.time"),":"]}),c.jsxs(r,{className:"value",children:[C(e.appointment_date)," ",e.appointment_time]})]}),c.jsxs(l,{className:"info-row",children:[c.jsxs(r,{className:"label",children:[j("user.pet"),":"]}),c.jsxs(r,{className:"value",children:[e.pet_type," \xb7 ",e.pet_breed]})]})]})]},s))})}),"store"===N&&c.jsx(l,{className:"tab-panel",children:c.jsxs(l,{className:"store-preview card",children:[c.jsx(r,{className:"section-title",children:j("user.store")}),c.jsx(r,{className:"store-name",children:j("user.store_name")}),c.jsx(r,{className:"store-address",children:j("user.store_address")}),c.jsx(r,{className:"store-phone",children:j("user.store_phone")}),c.jsx(r,{className:"store-hours",children:j("user.store_hours")}),c.jsx(n,{className:"view-detail-btn",onClick:w,children:j("user.view_details")})]})}),"services"===N&&c.jsx(l,{className:"tab-panel",children:c.jsxs(l,{className:"services-section card",children:[c.jsx(r,{className:"section-title",children:j("user.services_title")}),c.jsxs(l,{className:"service-item",children:[c.jsx(r,{className:"service-name",children:j("user.grooming")}),c.jsx(r,{className:"service-price",children:j("user.grooming_price")}),c.jsx(r,{className:"service-desc",children:j("user.grooming_desc")})]}),c.jsxs(l,{className:"service-item",children:[c.jsx(r,{className:"service-name",children:j("user.health_care")}),c.jsx(r,{className:"service-price",children:j("user.health_care_price")}),c.jsx(r,{className:"service-desc",children:j("user.health_care_desc")})]}),c.jsxs(l,{className:"service-item",children:[c.jsx(r,{className:"service-name",children:j("user.boarding")}),c.jsx(r,{className:"service-price",children:j("user.boarding_price")}),c.jsx(r,{className:"service-desc",children:j("user.boarding_desc")})]}),c.jsxs(l,{className:"service-item",children:[c.jsx(r,{className:"service-name",children:j("user.training")}),c.jsx(r,{className:"service-price",children:j("user.training_price")}),c.jsx(r,{className:"service-desc",children:j("user.training_desc")})]})]})}),"pets"===N&&c.jsx(l,{className:"tab-panel",children:c.jsxs(l,{className:"pets-section card",children:[c.jsx(r,{className:"section-title",children:j("user.pets")}),c.jsxs(l,{className:"empty-state",children:[c.jsx(r,{className:"empty-text",children:j("user.no_pets")}),c.jsx(n,{className:"add-pet-btn",onClick:()=>o({title:j("user.add_pet_developing")}),children:j("user.add_pet")})]})]})}),"history"===N&&c.jsx(l,{className:"tab-panel",children:c.jsxs(l,{className:"history-section card",children:[c.jsx(r,{className:"section-title",children:j("user.consumption_history")}),c.jsxs(l,{className:"history-stats",children:[c.jsxs(l,{className:"stat-item",children:[c.jsx(r,{className:"stat-value",children:b.filter(e=>"completed"===e.status).length}),c.jsx(r,{className:"stat-label",children:j("user.completed")})]}),c.jsxs(l,{className:"stat-item",children:[c.jsx(r,{className:"stat-value",children:b.filter(e=>"cancelled"===e.status).length}),c.jsx(r,{className:"stat-label",children:j("user.cancelled")})]}),c.jsxs(l,{className:"stat-item",children:[c.jsx(r,{className:"stat-value",children:b.filter(e=>"broken"===e.status).length}),c.jsx(r,{className:"stat-label",children:j("user.broken")})]})]}),c.jsxs(l,{className:"recent-appointments",children:[c.jsx(r,{className:"section-subtitle",children:j("user.recent_consumption")}),b.slice(0,5).map((e,s)=>c.jsxs(l,{className:"history-item",children:[c.jsx(r,{className:"service-name",children:e.service_name}),c.jsx(r,{className:"appointment-date",children:C(e.appointment_date)}),c.jsx(l,{className:`status-tag ${e.status}`,children:T(e.status)})]},s))]})]})})]})]})})]})};export{j as default};
